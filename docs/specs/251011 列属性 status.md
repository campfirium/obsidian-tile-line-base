# 列属性：status（任务状态）

## 概述

status 列属性用于 GTD 风格的任务状态管理，支持 5 种状态和快捷切换。

## 状态类型

共支持 5 种状态：

| 状态 | 显示图标 | 含义 | Unicode |
|------|---------|------|---------|
| todo | ☐ | 待办 | U+2610 |
| done | ☑ | 已完成 | U+2611 |
| inprogress | ⊟ | 进行中 | U+229F |
| onhold | ⏸ | 已搁置 | U+23F8 |
| canceled | ☒ | 已放弃 | U+2612 |

## 交互方式

### 左键点击：快速切换

最常用的操作：在 `todo` 和 `done` 之间切换

- 点击 `☐`（待办） → 变为 `☑`（已完成）
- 点击 `☑`（已完成） → 变为 `☐`（待办）
- 点击其他状态 → 统一变为 `☑`（已完成）

**设计理由**：
- 80% 的操作是"标记完成"或"取消完成"
- 单次点击即可完成最常用的操作
- 符合直觉的复选框交互模式

### 右键点击：完整菜单

显示所有 5 种状态的选择菜单：

```
进行中
已搁置
已放弃
---
复制
导出
```

**设计理由**：
- 其他 3 种状态（进行中、已搁置、已放弃）使用频率较低
- 通过右键菜单访问，不占用主交互路径
- 与 AG Grid 的默认右键菜单集成

## 视觉反馈

### 完成状态的行（done / canceled）

对于 `done`（已完成）和 `canceled`（已放弃）状态的行，应用以下样式：

1. **整行半透明**
   - `opacity: 0.5`
   - 弱化视觉权重，突出未完成的任务

2. **标题列添加删除线**
   - `text-decoration: line-through`
   - 明确标识任务已结束

### 状态图标样式

- 居中显示
- 字体大小：16px
- 可点击区域：整个单元格
- hover 时显示 pointer 光标

## 自动时间戳

### statusChanged 字段

每次状态变更时，自动记录变更时间：

```markdown
## 任务：实现登录功能
status：done
备注：已完成开发和测试
statusChanged：2025-10-11T02:15:23.866Z
```

**字段特性**：
- 压缩属性（不显示为列）
- 自动生成和更新
- 保存到文件
- ISO 8601 格式

**用途**：
- 复盘分析（完成耗时、搁置时长）
- 自动化触发（完成后发送通知）
- 数据统计（完成率、效率分析）

## 技术实现要点

### 1. 内置系统列

status 列应作为系统内置列：
- 自动添加到表格（无需手动定义）
- 默认位置：第二列（在第一个数据列后面）
- 列宽固定：60px
- 不可调整大小

### 2. 状态值规范化

支持多种别名（容错处理）：

```typescript
// done 的别名
'done' | 'completed'

// inprogress 的别名
'inprogress' | 'in-progress' | 'in_progress' | 'doing'

// onhold 的别名
'onhold' | 'on-hold' | 'on_hold' | 'hold' | 'paused'

// canceled 的别名
'canceled' | 'cancelled' | 'dropped'
```

### 3. 新行默认值

新增的行默认：
- `status: 'todo'`
- `statusChanged: [当前时间]`

### 4. 文件存储格式

```markdown
## 任务：核心操作的键盘快捷键
status：todo
备注：提升高阶用户的使用效率。
价值：65
成本（分钟）：30
statusChanged：2025-10-11T01:30:00.000Z

## 任务：复制行/批量删除行
status：done
备注：常用的批量编辑功能。
价值：60
成本（分钟）：45
statusChanged：2025-10-11T02:15:23.866Z
```

## 未来扩展

可能的扩展方向：

1. **自定义状态**：支持用户定义状态类型
2. **状态流转规则**：定义允许的状态转换路径
3. **状态统计**：在表格头部显示各状态的数量
4. **状态过滤器**：快速筛选特定状态的行
5. **状态历史**：记录完整的状态变更历史

## 参考案例

- Notion 的 status 属性
- Linear 的 issue status
- Todoist 的任务状态
- OmniFocus 的项目状态
