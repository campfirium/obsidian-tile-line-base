对，新窗口的问题和主窗口完全不是一个层级的 bug。大概的思路和要点是这样的：

------

### 核心思路

1. **多窗口上下文独立**
    在 Obsidian 里，每个 pop-out 窗口都有自己的 `window`、`document`、`app`、`workspace`。
    如果继续用全局的 `this.app.workspace` 或 `document`，那只会操作主窗口，pop-out 自然就静默了。
2. **视图注册和打开必须针对当前窗口**
    插件的 `registerView` 全局只需要一次，但在实际“打开视图”的时候，要确保是通过触发该窗口的 workspace 去做，而不是全局的。
3. **DOM 元素必须挂在该窗口的 document 上**
    所有 `createElement`、`activeElement`、`body.classList` 之类的地方，都要改成用 `containerEl.ownerDocument` 去拿。
4. **初始化时机**
    在 pop-out 窗口，元素挂载到 DOM 的节奏和主窗口不一样。要在它真正 attach 到那个 document 后再初始化 Grid（通常用该窗口的 `requestAnimationFrame` 去延迟一次）。

------

### 要点

- **打开表格视图时**：找到触发的 leaf，拿到它的 `ownerDocument.defaultView` → 通过这个窗口的 `app.workspace` 去创建/设置 view。
- **生命周期函数里**（`onOpen`、`setState`）：加日志和错误捕获，确认确实在 pop-out 里执行了。
- **Grid 配置**：`popupParent` 要指向该窗口的 `document.body`。
- **渲染器/编辑器**：一律用 `params.eGridCell.ownerDocument` 创建元素，避免跨窗口的 prototype mismatch。
- **window-open 事件**：监听 Obsidian 的 `window-open`，在每个新窗口里补充必要的初始化逻辑（样式、菜单、绑定）。

------

总结一下：主窗口能跑说明 Grid 自身没问题；新窗口不渲染就是因为**全局对象用错窗口了**。解决的方向就是——**让所有“视图打开、DOM 创建、编辑器初始化”的动作，都发生在那个 pop-out 窗口所属的 document/context 里**。

等你把这些上下文切换做全，新窗口就会和主窗口一样能跑表格。