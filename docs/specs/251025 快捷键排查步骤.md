# 251025 快捷键排查步骤

## 快捷开关
- 在 Obsidian 开发者工具控制台执行 `window.__TLB_DEBUG_INTERACTION__ = true;` 后，`AgGridInteractionController` 会输出调试日志。关闭调试可执行 `delete window.__TLB_DEBUG_INTERACTION__`。
- 日志前缀统一为 `[AgGridInteraction]`，便于筛选。

## 排查步骤
1. **聚焦事件校验**
   - 操作表格单元格，观察是否出现 `handleCellFocused` 日志，确认 `rowIndex` / `columnId` 正常。
   - 若无日志，排查 `AgGridAdapter` 的 `onCellFocused` 是否被调用，或是否存在焦点被禁止的情况。
2. **代理挂载确认**
   - 在聚焦日志后，应看到 `armProxyForCurrentCell:start`；若紧随其后出现 `cell-missing`，说明 DOM 查询失败。
   - 若 `captureResolved` 未出现，说明 `CompositionProxy` 未成功捕获，需继续关注 `armProxyForCurrentCell:captureError` 或 `cancelPendingCapture` 的原因。
3. **按键事件验证**
   - 按下 Enter/Tab/方向键时，应看到 `handleProxyKeyDown` 与 `moveFocus` 日志；若缺失，重点检查代理是否被挂起或被提前 cancel。
   - 在最后一行按 Enter，应出现 `handleEnterAtLastRow` 及 `handleEnterAtLastRow:callback`。
4. **删除/复制行为**
   - `Delete/Backspace` 触发 `handleDeleteKey:start / cleared`。
   - `Ctrl+C` 会打印 `handleCopyShortcut`，若在 `#` 列则还会输出 `hasCellEvent: true`，并随后触发 `onCopyH2Section`。
5. **编辑状态切换**
   - 进入/退出编辑查看 `handleCellEditingStarted/Stopped`，确保 `editing` 状态正确切换。

## 结果记录
- 每轮排查将关键信息（是否触发、参数值、异常日志）附加到 `docs/tasks/T0059_aggrid_refactor.md` 的 Phase 3 区域，便于跟踪。
- 若定位到具体问题，请同步更新 `specs/251025 快捷键逻辑回归分析.md` 的“主要差异与风险”章节。
