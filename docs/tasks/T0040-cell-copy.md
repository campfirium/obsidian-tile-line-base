# T0040-cell-copy

## 任务概述

排查并修复「单元格内容无法复制」的问题，确保用户可通过常规操作复制单元格文本。

## 问题描述

- 症状：在表格视图中选中单元格后执行复制（Ctrl+C / ⌘C）没有任何内容被写入剪贴板。
- 影响：用户无法将任务信息快速粘贴到其他文档或外部工具，影响效率。
- 场景：待复现确认（可能涉及编辑态/非编辑态、跨行选区、状态列等差异）。

## 初步假设

1. 复制快捷键被拦截：可能在 `AgGridAdapter` 的键盘处理逻辑里阻断了默认行为。
2. IME 捕获代理干扰：CompositionProxy 抢占焦点后未正确释放导致复制目标错误。
3. 浏览器安全限制：表格处于非文本输入状态时，AG Grid 需要显式启用 `enableCellTextSelection`。

## 调研计划

1. 复现路径：记录具体操作步骤（单元格聚焦 → 复制），捕获控制台日志。
2. 回溯历史：比对最近一次成功复制的版本，确认回归范围。
3. 代码排查：检查 `onCellKeyDown`、`CompositionProxy`、`gridApi.copySelectedRangeToClipboard` 等逻辑。

## 目标交付

- [ ] 复制快捷键在编辑态/非编辑态均可正常工作。
- [ ] 支持多单元格选中后复制为制表符分隔文本。
- [ ] 在 Obsidian 主窗口与 pop-out 窗口中行为一致。
- [ ] 更新 `docs/tasks/T0000.md` 状态及说明。

## 实施记录

- [ ] 2025-10-20：在 `AgGridAdapter` 中监听 Ctrl/Cmd+C，将当前聚焦单元格文本写入剪贴板。
