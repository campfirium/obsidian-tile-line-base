# 交互逻辑：表格视图 (TileLineBase)

> **更新日期：2025-10-10**
> 本文记录表格视图的交互规范，遵循 Excel 的交互习惯。

---

## 1. 单元格状态

- **未选中**：默认状态
- **选中**：高亮显示，但不进入编辑
- **编辑中**：可以输入内容

## 2. 单元格操作

| 操作 | 行为 |
| --- | --- |
| **左键单击** | 选中单元格（不进入编辑） |
| **双击** | 进入编辑模式 |
| **F2** | 进入编辑模式（Excel 习惯） |
| **Enter** | 移动到下一行的同一列<br>如果当前是最后一行：自动新增一行并进入编辑状态 |
| **Escape** | 退出编辑状态 / 关闭右键菜单 |
| **右键** | 弹出上下文菜单 |

## 3. 行操作

### 新增行
- 右键菜单：「在上方插入行」/「在下方插入行」
- 当前逻辑正常，保持不变

### 删除行
- 右键菜单：「删除此行」
- 当前逻辑正常，保持不变

## 4. 右键菜单

- **触发**：右键单击数据行
- **菜单项**：
  - 在上方插入行
  - 在下方插入行
  - ——（分隔线）
  - 删除此行
- **隐藏**：点击其他位置 / 按 Escape
- **已知问题**：菜单在屏幕底部时可能被截断，需要优化定位逻辑

## 5. 需要实现的功能

### P0 - 核心交互
1. **单元格选中状态**：左键单击只选中，不进入编辑
2. **F2 进入编辑**：像 Excel 一样
3. **Enter 智能换行**：
   - 非最后一行：移动到下一行同一列
   - 最后一行：新增一行并自动进入编辑状态
4. **右键菜单定位优化**：防止菜单超出屏幕

### P1 - 后续优化
- 快捷键支持（如有需要）
- 其他交互细节

---

## 实现任务拆分

### T0016 - Excel 式单元格交互
**目标**：实现 Excel 风格的单元格选中和编辑分离

- [x] 左键单击：只选中单元格，不进入编辑
- [x] 双击：进入编辑模式
- [ ] F2：进入编辑模式
- [x] Enter：移动到下一行同一列
- [x] 最后一行 Enter：新增一行并进入编辑


### T0017 - 右键菜单定位优化
**目标**：防止右键菜单超出屏幕

- [ ] 检测菜单是否超出屏幕底部
- [ ] 超出时自动向上调整位置
