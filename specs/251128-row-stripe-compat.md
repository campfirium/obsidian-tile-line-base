# 目标与背景
- 目标：在 Obsidian 各类主题下保持 AG Grid 行条纹可见，避免因主题自定义变量导致奇偶行无差别。
- 当前实现：条纹强度/边框对比度可在插件设置中调节，默认条纹 100%、边框 40%，设置变更即时刷新现有表格容器。条纹色优先取 `background-primary-alt`、`background-secondary`，否则回退到 `background-modifier-hover`，再没有则用固定对比色（深色 `rgba(255,255,255,0.14)`，浅色 `rgba(0,0,0,0.08)`），必要时直接写入 `--ag-odd-row-background-color` 提升可见度。

# 触发问题的主题特征
- 部分第三方主题（示例：`tmp/theme.css`）将 `--background-primary`、`--background-secondary`、`--background-primary-alt` 都绑定到同一组 `--surface` / `--overlay`，并可能带透明度参数，导致颜色解析后几乎同色。
- 主题没有提供任何 `--ag-*` 覆写，AG Grid 只能依赖我们注入的 CSS 变量；若主/次/alt 同色且 hover 色也接近背景，条纹对比度会被严重稀释。
- 该类主题的 hover/选中有明显对比度（使用 `--background-modifier-hover`），但行条纹使用的背景链路被同色覆盖，导致奇偶行无法区分。

# 已尝试的兜底手段
- 调整条纹基色选择：primary-alt > secondary > background-modifier-hover > 固定对比色。
- 增强“同色”检测：解析主题变量字符串并检测主/次/alt 是否相同。
- 在检测到无可用次级颜色时，直接写入 `--ag-odd-row-background-color`，并提升条纹强度（至少 0.9），绕开主题变量链。
- 固定对比色兜底：深色使用 `rgba(255,255,255,0.14)`，浅色使用 `rgba(0,0,0,0.08)`。
- 条纹/边框滑杆即时刷新，避免用户手动重载。

# 仍然存在的问题
- 对于主/次/alt 全同色且 hover 色依然与背景接近的主题，条纹仍可能不可感知。
- 主题自身若后置样式覆盖 `--ag-odd-row-background-color` 或对行容器设置更高优先级样式，当前兜底仍无法生效。
- 未找到通用的“安全且不破坏主题风格”的方案，只能在极端主题上以更强对比色强制覆盖，可能与主题配色冲突。

# 后续可选方案
1) 在检测到极端同色主题时，直接使用固定高对比度条纹色（例如深色 `rgba(255,255,255,0.25)` / 浅色 `rgba(0,0,0,0.12)`），完全跳过背景混色，并通过重要性或内联方式覆盖可能的主题行样式。
2) 提供“强制条纹”开关：仅在用户开启时启用上面的强对比覆盖，避免默认影响其他主题。
3) 文档提示主题作者：为 AG Grid 兼容预留 `--background-secondary` 与 `--background-primary-alt`，或避免在行容器上写死背景。

# 现状
- 代码已包含多级兜底和设置滑杆，适配大部分主题；少数极端同色主题仍可能无条纹。
- 后续若要继续优化，应在“不破坏其它主题”的前提下，再引入强制覆盖或用户可选的“强制条纹”模式。
