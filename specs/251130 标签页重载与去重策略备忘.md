# 背景
- 任务：T0219 标签页不停重载。
- 场景：启用/更新其他插件后，处于表格/看板/幻灯片视图的标签会频繁关闭重开，表格视图与 Markdown 视图间来回切换，偶尔需要多开新标签才会停止。
- 现状：TableView 默认避免同一文件生成重复表格标签，直接跳转到已有标签。

# 成因分析
1) 标签被强制关闭：`ViewSwitchCoordinator.openTableView` 在发现同文件已有表格视图时，主动 `detach` 当前叶子以“去重”。当其他插件或用户操作触发视图切换时，这个 `detach` 会关闭正在使用的标签，再触发自动切换逻辑，形成“关闭→重开→再关闭”的循环。
2) 自动切换放大循环：`active-leaf-change` 与 `file-open` 事件会尝试自动切换到表格视图，配合上面的 `detach`，在短时间内被连续触发，导致闪烁。
3) 修改时间异常：`ConversionSessionManager.restoreBaselineIfEligible` 即便内容未变也写回文件，导致单纯打开/切换时刷新 mtime。

# 已采取的修复
- 去掉复用时的 `detach`：保留已有表格视图并跳转，但不强制关闭当前标签，避免“关-开”循环。
- 自动切换防抖/熔断：在 `maybeSwitchToTableView` 增加快速循环检测，4 秒内触发 3 次则冷却 5 秒；每次自动切换后也短暂冷却，减小争抢焦点。
- `active-leaf-change` 冷却检查：如果文件被标记禁止自动切换，则跳过当前自动跳转。
- 基线还原优化：恢复前先比对当前内容与基线，内容一致则跳过写回，避免无改动刷新修改时间。
- 任务记录：`docs/tasks/T0219_tab-reload.md`。

# 去重策略评估
- 保持去重（当前策略）的优点：
  - 避免同一文件多视图同时写入导致“最后写入者覆盖”。
  - 资源占用低，减少多实例监听带来的性能负担。
  - 视图偏好/模式、筛选状态等设置不被多实例互相覆盖。
- 取消去重的风险：
  - 多视图并行编辑会有写入竞态，自动保存/刷新仍是“最后写入覆盖”。
  - 每个视图的基线、筛选、列宽等状态独立，保存时会互相覆盖设置。
  - 性能随视图数量线性增加。
- 可选方案（暂未实施）：
  - 提供开关允许多开或按修饰键临时多开。
  - 只读副本：首个视图可写，其余只读以供查看/对比，避免写入竞态。
  - 若未来实现多开，需要明确覆盖提示或更长的保存去抖。

# 当前决策
- 保持“同一文件只保留一个表格视图”的默认行为，配合冷却与防抖，避免闪烁与覆盖风险。
